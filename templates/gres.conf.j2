AutoDetect={{ openhpc_gres_autodetect }}
{% for nodegroup in openhpc_nodegroups %}
{%      set inventory_group_name = openhpc_cluster_name ~ '_' ~ nodegroup.name %}
{%      set inventory_group_hosts = groups.get(inventory_group_name, []) %}
{%      set hostlist_string  = inventory_group_hosts | hostlist_expression | join(',') %}
{%      for gres in nodegroup.gres | default([]) %}
{%          set gres_name, gres_type, _ = gres.conf.split(':') %}
NodeName={{ hostlist_string }}{% if 'gres_autodetect' in nodegroup %} AutoDetect={{ nodegroup.gres_autodetect }}{% endif %} Name={{ gres_name }} Type={{ gres_type }}{% if 'file' in gres %} File={{ gres.file }}{% endif %}

{%      endfor %}{# gres #}
{% endfor %}{# nodegroup #}
